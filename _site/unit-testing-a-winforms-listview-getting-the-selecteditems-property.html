<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<title>Unit testing a WinForms ListView - getting the SelectedItems property</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description" content="Bec d'état, Rebecca Scott's personal blog"/>
		<meta name="author" content="Rebecca Scott"/>
		<link rel="icon" href="/favicon.ico"/>
		<link href="//fonts.googleapis.com/css?family=Cinzel" rel="stylesheet" type="text/css"/>
		<link href="//fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css"/>
		<link href="/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
		<link href="/lib/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"/>
		<link href="/css/site.css" rel="stylesheet"/>
	</head>
	<body>
		<div class="container">
			<div class="row header">
				<h1><a href="https://becdetat.com">Bec d'état</a></h1>
				<h2>
					<a href="https://becdetat.com">Rebecca Scott's Blog</a>
					<br/>
					<a href="/about-me">About me</a> |
					<a href="/resume">Resume</a>
					<br/>
					<a href="https://www.linkedin.com/in/rebecca-scott-b522a418/" target="_blank">LinkedIn</a> |
					<a href="https://github.com/becdetat" target="_blank">GitHub</a> |
					<a href="mailto:me@becdetat.com">me@becdetat.com</a>
				</h2>
			</div>
		</div>

		<hr/>

		<div class="container">
			<div class="row content">

				<!-- CONTENT! -->
				<h1><a href="/">~/</a>Unit testing a WinForms ListView - getting the SelectedItems property <br/></h1>
<h2><small><em>22 Dec 2010</em></small></h2>

<p>Quick tip / reminder to myself. I’m adding some tests to an ancient (almost two years old :-) ) Winforms control that uses a ListView. All I’m doing is making sure that a particular context menu item is enabled or disabled depending on the state of the object in the tag of the selected item in the ListView. The details aren’t important. Trust me.</p>

<p>The issue is that since the control being tested is never actually displayed, the ListView control doesn’t update its SelectedItems property. I found a Stack Overflow <a href="https://stackoverflow.com/questions/304844/why-do-selectedindices-and-selecteditems-not-work-when-listview-is-instantiated-i">question and answer</a> regarding this. The (marked as) ‘correct’ answer involves flashing up a hidden form containing the control. Potentially messy. If I was testing a form I could just flash that up but still, not an ideal solution. The <a href="https://stackoverflow.com/questions/304844/why-do-selectedindices-and-selecteditems-not-work-when-listview-is-instantiated-i/518411#518411">second answer</a> to the question does the trick. Fourth line is the money shot:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Select the first list view item:
controlBeingTested.myListView.Items[0].Selected = true;
// then trick controlBeingTested.myListView.SelectedItems into being updated:
controlBeingTested.myListView.AccessibilityObject.ToString();
</code></pre></div></div>

<p>The downside is that the <code class="language-plaintext highlighter-rouge">Accessibility</code> reference needs to be added to the unit test assembly.</p>



<br/>

<div id="disqus_thread"></div>
<script>
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://becdetat.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

				<!-- /CONTENT! -->

			</div>
		</div>

		<hr/>

		<div class="container">
			<div class="row footer">
				<p><small>
					Content &copy; 2008-2022 Rebecca Scott<br/>
					<a href="https://www.linkedin.com/in/rebecca-scott-b522a418/" target="_blank">LinkedIn</a> |
					<a href="https://github.com/becdetat" target="_blank">GitHub</a> |
					<a href="mailto:me@becdetat.com">me@becdetat.com</a>
				</small></p>
			</div>
		</div>

		<script src="/lib/jquery-2.0.2.min.js"></script>
		<script src="/lib/bootstrap/js/bootstrap.min.js"></script>
		<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
		<script src="/js/site.js"></script>
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-67018713-1', 'auto');
		  ga('send', 'pageview');
		</script>
	</body>
</html>
