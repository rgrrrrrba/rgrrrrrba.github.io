<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<title>Google via Ruby console tool</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description" content="Bec d'état, Rebecca Scott's personal blog"/>
		<meta name="author" content="Rebecca Scott"/>
		<link rel="icon" href="/favicon.ico"/>
		<link href="//fonts.googleapis.com/css?family=Cinzel" rel="stylesheet" type="text/css"/>
		<link href="//fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css"/>
		<link href="/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
		<link href="/lib/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"/>
		<link href="/css/site.css" rel="stylesheet"/>
	</head>
	<body>
		<div class="container">
			<div class="row header">
				<h1><a href="https://becdetat.com">Bec d'état</a></h1>
				<h2>
					<a href="https://becdetat.com">Rebecca Scott's Blog</a>
					<br/>
					<a href="/">Home</a> |
					<a href="/about-me">About me</a> |
					<a href="/resume">Resume</a> |
					<a href="/links">Links</a> |
					<a href="/archive">Archive</a>
					<br/>
					<a href="https://www.linkedin.com/in/rebecca-scott-b522a418/" target="_blank">LinkedIn</a> |
					<a href="https://github.com/becdetat" target="_blank">GitHub</a> |
					<a href="mailto:me@becdetat.com">me@becdetat.com</a>
				</h2>
			</div>
		</div>

		<hr/>

		<div class="container">
			<div class="row content">

				<!-- CONTENT! -->
				<h1><a href="/">~/</a>Google via Ruby console tool <br/></h1>
<h2><small><em>01 Aug 2010</em></small></h2>

<p>So I’ve been getting my console-fu on since moving to [Mercurial][https://blog.belfryimages.com.au/category/mercurial/] at work, and finding ways to get more efficient. One thing that bugs me is having to spend time grabbing the mouse to search Google via a browser. I’ve also wanted to spend some time with Ruby, so to acheive both goals I wrote a little script that uses the Google AJAX Search API, which returns search results as a JSON object. The full code is available as a [gist on my GitHub][https://gist.github.com/503145]. There are a couple of interesting (for me anyway) parts of the code that I’ll go through now.</p>

<p>The request/response is done via a HTTP GET responding with a JSON-serialised object graph. A query string is built up and parsed into a URI object (using the same reference), then the request is made and parsed from the text JSON representation into an associative array (the result of JSON.parse):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require 'net/http'
require 'json'
...
queryURI = "https://ajax.google....."
queryURI = URI.parse(queryURI)
 
data = Net::HTTP.get_response(queryURI)
data = data.body
data = JSON.parse(data)
</code></pre></div></div>

<p>I’ve used both pre- and post-fix conditional structures:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if command.to_i.to_s == command &amp;&amp; (1..results.length).include?(command.to_i)
  url = results[command.to_i - 1]['url']
  puts "Opening #{url}"
  `start #{url}`
  command = ''
end
 
page += 1 if command == '+'
page -= 1 if command == '-'
</code></pre></div></div>

<p>Rather than using a not operator like ! the unless operator can be more fluent and easier to understand:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command = '' unless ['+','-','q'].include?(command)
</code></pre></div></div>

<p>A problem with C#’s foreach loop syntax is that there is no easy way to include an index short of rolling your own and incrementing in the loop. Usually it is easier to resort to the less pretty for (var i = 0; i &lt; ..; i++) syntax. Ruby includes a variant of Array::each that takes care of the index:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>results.each_with_index do |result, index|
  # ...
end
</code></pre></div></div>

<p>And of course writing two line breaks is very fun:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.times { puts '' }
</code></pre></div></div>

<p>All up it was very educational spending some time building something a bit significant in Ruby, and the result should hopefully be pretty fun to use.</p>



<br/>

<div id="disqus_thread"></div>
<script>
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://becdetat.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

				<!-- /CONTENT! -->

			</div>
		</div>

		<hr/>

		<div class="container">
			<div class="row footer">
				<p><small>
					Content &copy; 2008-2022 Rebecca Scott<br/>
					<a href="https://www.linkedin.com/in/rebecca-scott-b522a418/" target="_blank">LinkedIn</a> |
					<a href="https://github.com/becdetat" target="_blank">GitHub</a> |
					<a href="mailto:me@becdetat.com">me@becdetat.com</a>
				</small></p>
			</div>
		</div>

		<script src="/lib/jquery-2.0.2.min.js"></script>
		<script src="/lib/bootstrap/js/bootstrap.min.js"></script>
		<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
		<script src="/js/site.js"></script>
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-67018713-1', 'auto');
		  ga('send', 'pageview');
		</script>
	</body>
</html>
